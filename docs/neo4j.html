<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Neo4j | 不可思议</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="xchenhao.gitee.io">
    <link rel="preload" href="/assets/css/0.styles.8dfbbd61.css" as="style"><link rel="preload" href="/assets/js/app.40b884d2.js" as="script"><link rel="preload" href="/assets/js/3.3ea64767.js" as="script"><link rel="preload" href="/assets/js/6.6ba35d9e.js" as="script"><link rel="prefetch" href="/assets/js/10.6702d7bf.js"><link rel="prefetch" href="/assets/js/11.81620c6a.js"><link rel="prefetch" href="/assets/js/12.6eec5261.js"><link rel="prefetch" href="/assets/js/13.eecbe465.js"><link rel="prefetch" href="/assets/js/14.a6c5e4ea.js"><link rel="prefetch" href="/assets/js/15.777c418c.js"><link rel="prefetch" href="/assets/js/16.6f3fce90.js"><link rel="prefetch" href="/assets/js/17.14876ee0.js"><link rel="prefetch" href="/assets/js/18.1b560f70.js"><link rel="prefetch" href="/assets/js/19.db99086f.js"><link rel="prefetch" href="/assets/js/20.4ced4823.js"><link rel="prefetch" href="/assets/js/21.1c9b0c54.js"><link rel="prefetch" href="/assets/js/22.5873aa3a.js"><link rel="prefetch" href="/assets/js/23.57ddda35.js"><link rel="prefetch" href="/assets/js/24.b7444309.js"><link rel="prefetch" href="/assets/js/25.fdf77843.js"><link rel="prefetch" href="/assets/js/26.a9d42d14.js"><link rel="prefetch" href="/assets/js/27.a5a51ade.js"><link rel="prefetch" href="/assets/js/28.5561ecd0.js"><link rel="prefetch" href="/assets/js/29.e63bd8d1.js"><link rel="prefetch" href="/assets/js/30.59249eab.js"><link rel="prefetch" href="/assets/js/31.79abfa92.js"><link rel="prefetch" href="/assets/js/32.8fdf366b.js"><link rel="prefetch" href="/assets/js/33.42a288d4.js"><link rel="prefetch" href="/assets/js/34.779de91e.js"><link rel="prefetch" href="/assets/js/35.8ee608aa.js"><link rel="prefetch" href="/assets/js/36.629e5b79.js"><link rel="prefetch" href="/assets/js/37.af2f9fe5.js"><link rel="prefetch" href="/assets/js/38.9433c305.js"><link rel="prefetch" href="/assets/js/39.21a61ab5.js"><link rel="prefetch" href="/assets/js/4.0543ed79.js"><link rel="prefetch" href="/assets/js/40.003f2546.js"><link rel="prefetch" href="/assets/js/41.3b6d6a34.js"><link rel="prefetch" href="/assets/js/42.4d8658cf.js"><link rel="prefetch" href="/assets/js/43.952f8d77.js"><link rel="prefetch" href="/assets/js/44.423bdace.js"><link rel="prefetch" href="/assets/js/45.2500955f.js"><link rel="prefetch" href="/assets/js/46.e4d8c366.js"><link rel="prefetch" href="/assets/js/47.07e64e10.js"><link rel="prefetch" href="/assets/js/48.b7f8badf.js"><link rel="prefetch" href="/assets/js/49.12d47ca3.js"><link rel="prefetch" href="/assets/js/5.f05ac99b.js"><link rel="prefetch" href="/assets/js/50.85353aa7.js"><link rel="prefetch" href="/assets/js/51.8a57beb8.js"><link rel="prefetch" href="/assets/js/52.638d584e.js"><link rel="prefetch" href="/assets/js/53.4c571960.js"><link rel="prefetch" href="/assets/js/54.bc41d0b5.js"><link rel="prefetch" href="/assets/js/55.43685358.js"><link rel="prefetch" href="/assets/js/7.7b187e09.js"><link rel="prefetch" href="/assets/js/8.e7e79ea1.js"><link rel="prefetch" href="/assets/js/9.97236a62.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.d51abae4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8dfbbd61.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">不可思议</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          数据库
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          语言
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shell</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>其它</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/JetBrainsCrack.html" title="JetBrains IDE 破解教程" class="sidebar-link">JetBrains IDE 破解教程</a></li><li><a href="/WebTorrent.html" title="WebTorrent 下载磁力链接工具" class="sidebar-link">WebTorrent 下载磁力链接工具</a></li><li><a href="/HTTP-Protocol.html" title="HTTP 协议" class="sidebar-link">HTTP 协议</a></li><li><a href="/TDD-note.html" title="TDD 笔记" class="sidebar-link">TDD 笔记</a></li><li><a href="/vim-note.html" title="Vim 笔记" class="sidebar-link">Vim 笔记</a></li><li><a href="/network-note-1.html" title="网络笔记" class="sidebar-link">网络笔记</a></li><li><a href="/Git.html" title="Git" class="sidebar-link">Git</a></li><li><a href="/Docker-note.html" title="Docker" class="sidebar-link">Docker</a></li><li><a href="/openresty/openresty.html" title="OpenResty" class="sidebar-link">OpenResty</a></li><li><a href="/neo4j.html" aria-current="page" title="Neo4j" class="active sidebar-link">Neo4j</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><a href="/books-note.html" title="读书笔记" class="sidebar-link">读书笔记</a></li><li><a href="/update_log.html" title="更新记录" class="sidebar-link">更新记录</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h3 id="neo4j"><a href="#neo4j" class="header-anchor">#</a> Neo4j</h3> <p><img src="/assets/img/search-relation-demo.5b708bd0.jpg" alt="relation"></p> <p>[TOC]</p> <h4 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h4> <ul><li><p>定义：一种基于图论实现  NoSQL 的数据库管理系统，用节点和关系、属性表现实体内容</p> <p><img src="/assets/img/node_relation_attr.9723a772.jpg" alt="node_relation_attr"></p></li> <li><p>特点：</p> <ul><li><p>根据其连接的关系可以快速找出其邻近节点</p></li> <li><p>支持 ACID</p></li> <li><p>社区版只能单机使用，企业版才能使用分布式安装（负载均衡与高可用）</p></li></ul></li> <li><p>应用领域</p> <ul><li>社交网络、推荐引擎、交通物流、欺诈风控</li></ul></li> <li><p>不适用场景：</p> <ul><li><p>记录大量基于事件的数据</p></li> <li><p>需要对大规模分布式数据进行处理</p></li> <li><p>二进制数据存储</p></li> <li><p>适合保存在关系型数据库的结构化数据</p></li></ul></li> <li><p>下载：https://neo4j.com/download-center/#community</p></li></ul> <p><img src="/assets/img/download.13cab54d.png" alt="download"></p> <h4 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 前置依赖 JRE(Java Runtime Environment)</span>

$ <span class="token builtin class-name">cd</span> <span class="token operator">&lt;</span>NEO4J_HOME<span class="token operator">&gt;</span>

$ <span class="token function">vim</span> ./conf/neo4j.conf
<span class="token comment"># The name of the default database</span>
dbms.default_database<span class="token operator">=</span>sanguo

<span class="token comment"># Bolt connector</span>
dbms.connector.bolt.enabled<span class="token operator">=</span>true
dbms.connector.bolt.tls_level<span class="token operator">=</span>DISABLED
dbms.connector.bolt.listen_address<span class="token operator">=</span>:7687

<span class="token comment"># HTTP Connector. There can be zero or one HTTP connectors.</span>
dbms.connector.http.enabled<span class="token operator">=</span>true
dbms.connector.http.listen_address<span class="token operator">=</span>:7474

$ ./bin/neo4j console
<span class="token number">2021</span>-02-27 02:45:15.154+0000 INFO  Starting<span class="token punctuation">..</span>.
<span class="token number">2021</span>-02-27 02:45:21.637+0000 INFO  <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> Neo4j <span class="token number">4.2</span>.3 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token number">2021</span>-02-27 02:45:26.105+0000 INFO  Performing postInitialization step <span class="token keyword">for</span> component <span class="token string">'security-users'</span> with version <span class="token number">2</span> and status CURRENT
<span class="token number">2021</span>-02-27 02:45:26.106+0000 INFO  Updating the initial password <span class="token keyword">in</span> component <span class="token string">'security-users'</span>
<span class="token number">2021</span>-02-27 02:45:34.404+0000 INFO  Bolt enabled on localhost:7687.
<span class="token number">2021</span>-02-27 02:45:35.254+0000 INFO  Remote interface available at http://localhost:7474/
<span class="token number">2021</span>-02-27 02:45:35.255+0000 INFO  Started
</code></pre></div><p>终端 Shell 访问</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ ./bin/cypher-shell -a <span class="token number">127.0</span>.0.1 -u neo4j -p <span class="token number">123456</span>
Connected to Neo4j using Bolt protocol version <span class="token number">4.2</span> at neo4j://127.0.0.1:7687 as user neo4j.
Type :help <span class="token keyword">for</span> a list of available commands or :exit to <span class="token builtin class-name">exit</span> the shell.
Note that Cypher queries must end with a semicolon.

neo4j@sanguo<span class="token operator">&gt;</span> MATCH <span class="token punctuation">(</span>n<span class="token punctuation">)</span> RETURN n<span class="token punctuation">;</span>
+------------------------+
<span class="token operator">|</span> n                      <span class="token operator">|</span>
+------------------------+
<span class="token operator">|</span> <span class="token punctuation">(</span>:Country <span class="token punctuation">{</span>name: <span class="token string">&quot;魏&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token punctuation">(</span>:Country <span class="token punctuation">{</span>name: <span class="token string">&quot;吴&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token punctuation">(</span>:Country <span class="token punctuation">{</span>name: <span class="token string">&quot;蜀&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">|</span>
+------------------------+
</code></pre></div><p>浏览器访问：</p> <blockquote><p>输入数据库名（sanguo），默认用户名及密码（neo4j）
<img src="/assets/img/image-20210227141802646.b265d6cb.png" alt="输入连接信息"> <img src="/assets/img/image-20210227141830862.c86341eb.png" alt="首页"></p></blockquote> <h4 id="导入数据"><a href="#导入数据" class="header-anchor">#</a> 导入数据</h4> <h5 id="准备数据集"><a href="#准备数据集" class="header-anchor">#</a> 准备数据集</h5> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 查看数据导入的目录</span>
$ <span class="token function">less</span> ./conf/neo4j.conf
<span class="token comment"># This setting constrains all `LOAD CSV` import files to be under the `import` directory. Remove or comment it out to</span>
<span class="token comment"># allow files to be loaded from anywhere in the filesystem; this introduces possible security problems. See the</span>
<span class="token comment"># `LOAD CSV` section of the manual for details.</span>
dbms.directories.import<span class="token operator">=</span>import

<span class="token comment"># 将数据集（csv）下载至 import 目录</span>
$ <span class="token function">wget</span> -O ./import/sanguo.csv <span class="token string">'https://raw.githubusercontent.com/wangfangye/kg-hongloumeng/master/data/data/三国演义/triples.csv'</span>
--2021-02-26 <span class="token number">19</span>:21:46--  https://raw.githubusercontent.com/wangfangye/kg-hongloumeng/master/data/data/%E4%B8%89%E5%9B%BD%E6%BC%94%E4%B9%89/triples.csv
Resolving raw.githubusercontent.com <span class="token punctuation">(</span>raw.githubusercontent.com<span class="token punctuation">)</span><span class="token punctuation">..</span>. <span class="token number">185.199</span>.109.133, <span class="token number">185.199</span>.110.133, <span class="token number">185.199</span>.111.133, <span class="token punctuation">..</span>.
Connecting to raw.githubusercontent.com <span class="token punctuation">(</span>raw.githubusercontent.com<span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">185.199</span>.109.133<span class="token operator">|</span>:443<span class="token punctuation">..</span>. connected.
HTTP request sent, awaiting response<span class="token punctuation">..</span>. <span class="token number">200</span> OK
Length: <span class="token number">5926</span> <span class="token punctuation">(</span><span class="token number">5</span>.8K<span class="token punctuation">)</span> <span class="token punctuation">[</span>text/plain<span class="token punctuation">]</span>
Saving to: ‘import/sanguo.csv’

import/sanguo.csv                          <span class="token number">100</span>%<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>   <span class="token number">5</span>.79K  --.-KB/s    <span class="token keyword">in</span> 0s      

<span class="token number">2021</span>-02-26 <span class="token number">19</span>:21:47 <span class="token punctuation">(</span><span class="token number">26.6</span> MB/s<span class="token punctuation">)</span> - ‘import/sanguo.csv’ saved <span class="token punctuation">[</span><span class="token number">5926</span>/5926<span class="token punctuation">]</span>

$ <span class="token function">ls</span> ./import/
sanguo.csv

$ <span class="token function">head</span> ./import/sanguo.csv
<span class="token string">&quot;head&quot;</span>,<span class="token string">&quot;tail&quot;</span>,<span class="token string">&quot;relation&quot;</span>,<span class="token string">&quot;label&quot;</span>
<span class="token string">&quot;关羽&quot;</span>,<span class="token string">&quot;刘备&quot;</span>,<span class="token string">&quot;younger_sworn_brother&quot;</span>,<span class="token string">&quot;义弟&quot;</span>
<span class="token string">&quot;张飞&quot;</span>,<span class="token string">&quot;刘备&quot;</span>,<span class="token string">&quot;younger_sworn_brother&quot;</span>,<span class="token string">&quot;义弟&quot;</span>
<span class="token string">&quot;关羽&quot;</span>,<span class="token string">&quot;张飞&quot;</span>,<span class="token string">&quot;elder_sworn_brother&quot;</span>,<span class="token string">&quot;义兄&quot;</span>
<span class="token string">&quot;张苞&quot;</span>,<span class="token string">&quot;张飞&quot;</span>,<span class="token string">&quot;son&quot;</span>,<span class="token string">&quot;儿子&quot;</span>
<span class="token string">&quot;关兴&quot;</span>,<span class="token string">&quot;关羽&quot;</span>,<span class="token string">&quot;son&quot;</span>,<span class="token string">&quot;儿子&quot;</span>
<span class="token string">&quot;关平&quot;</span>,<span class="token string">&quot;张苞&quot;</span>,<span class="token string">&quot;sworn&quot;</span>,<span class="token string">&quot;结拜&quot;</span>
<span class="token string">&quot;关平&quot;</span>,<span class="token string">&quot;关羽&quot;</span>,<span class="token string">&quot;adopted_son&quot;</span>,<span class="token string">&quot;义子&quot;</span>
<span class="token string">&quot;卢植&quot;</span>,<span class="token string">&quot;刘备&quot;</span>,<span class="token string">&quot;master&quot;</span>,<span class="token string">&quot;师傅&quot;</span>
<span class="token string">&quot;公孙瓒&quot;</span>,<span class="token string">&quot;刘备&quot;</span>,<span class="token string">&quot;friend&quot;</span>,<span class="token string">&quot;朋友&quot;</span>
</code></pre></div><h5 id="创建节点"><a href="#创建节点" class="header-anchor">#</a> 创建节点</h5> <blockquote><p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MERGE (:Hero { name: line.tail});</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','<br>
MERGE (:Hero { name: line.head});</p></blockquote> <blockquote><p>MATCH (n) RETURN n;
<img src="/assets/img/all_nodes.15600c9f.png" alt="all_nodes"></p></blockquote> <h5 id="创建关系"><a href="#创建关系" class="header-anchor">#</a> 创建关系</h5> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">awk</span> -F <span class="token string">','</span> <span class="token string">'{ print <span class="token variable">$4</span> }'</span>  ./import/sanguo.csv <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span>
<span class="token string">&quot;label&quot;</span>
<span class="token string">&quot;主公&quot;</span>
<span class="token string">&quot;义兄&quot;</span>
<span class="token string">&quot;义女&quot;</span>
<span class="token string">&quot;义子&quot;</span>
<span class="token string">&quot;义弟&quot;</span>
<span class="token string">&quot;义父&quot;</span>
<span class="token string">&quot;儿子&quot;</span>
<span class="token string">&quot;叔叔&quot;</span>
<span class="token string">&quot;同事&quot;</span>
<span class="token string">&quot;同族&quot;</span>
<span class="token string">&quot;哥哥&quot;</span>
<span class="token string">&quot;堂弟&quot;</span>
<span class="token string">&quot;夫&quot;</span>
<span class="token string">&quot;女儿&quot;</span>
<span class="token string">&quot;女婿&quot;</span>
<span class="token string">&quot;妹妹&quot;</span>
<span class="token string">&quot;妻&quot;</span>
<span class="token string">&quot;妻子&quot;</span>
<span class="token string">&quot;妾&quot;</span>
<span class="token string">&quot;嫂子&quot;</span>
<span class="token string">&quot;岳母&quot;</span>
<span class="token string">&quot;师傅&quot;</span>
<span class="token string">&quot;弟弟&quot;</span>
<span class="token string">&quot;徒弟&quot;</span>
<span class="token string">&quot;朋友&quot;</span>
<span class="token string">&quot;母亲&quot;</span>
<span class="token string">&quot;父亲&quot;</span>
<span class="token string">&quot;结拜&quot;</span>
<span class="token string">&quot;臣&quot;</span>
<span class="token string">&quot;让位&quot;</span>
<span class="token string">&quot;诸侯&quot;</span>
</code></pre></div><blockquote><p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '义女' MERGE (h1)-[:义女]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '义子' MERGE (h1)-[:义子]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '义父' MERGE (h1)-[:义父]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '徒弟' MERGE (h1)-[:徒弟]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '同事' MERGE (h1)-[:同事]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '妾' MERGE (h1)-[:妾]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '女儿' MERGE (h1)-[:女儿]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '让位' MERGE (h1)-[:让位]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '哥哥' MERGE (h1)-[:哥哥]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '义兄' MERGE (h1)-[:义兄]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '父亲' MERGE (h1)-[:父亲]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '朋友' MERGE (h1)-[:朋友]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '夫' MERGE (h1)-[:夫]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '主公' MERGE (h1)-[:主公]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '师傅' MERGE (h1)-[:师傅]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '臣' MERGE (h1)-[:臣]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '母亲' MERGE (h1)-[:母亲]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '岳母' MERGE (h1)-[:岳母]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '诸侯' MERGE (h1)-[:诸侯]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '同族' MERGE (h1)-[:同族]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '嫂子' MERGE (h1)-[:嫂子]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '儿子' MERGE (h1)-[:儿子]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '女婿' MERGE (h1)-[:女婿]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '堂弟' MERGE (h1)-[:堂弟]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '结拜' MERGE (h1)-[:结拜]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '叔叔' MERGE (h1)-[:叔叔]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '妻子' MERGE (h1)-[:妻子]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '弟弟' MERGE (h1)-[:弟弟]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '妹妹' MERGE (h1)-[:妹妹]-&gt;(h2);</p> <p>LOAD CSV WITH HEADERS FROM 'file:///sanguo.csv' AS line FIELDTERMINATOR ','
MATCH (h1:Hero),(h2:Hero) WHERE h1.name = line.head AND h2.name = line.tail AND line.label = '义弟' MERGE (h1)-[:义弟]-&gt;(h2);</p></blockquote> <blockquote><p>MATCH (n) RETURN n
<img src="/assets/img/nodes_and_relations.9b619111.png" alt="nodes_relations"></p></blockquote> <h4 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h4> <blockquote><p>RETURN (:Hero{name:&quot;曹操&quot;})-[*..1]-&gt;(:Hero)
<img src="/assets/img/image-20210227142908735.d0d1ced7.png" alt="image-20210227142908735"></p></blockquote> <blockquote><p>PROFILE RETURN (:Hero{name:&quot;曹操&quot;})-[<em>..1]-&gt;(:Hero)
EXPLAIN RETURN (:Hero{name:&quot;曹操&quot;})-[</em>..1]-&gt;(:Hero)
<img src="/assets/img/no_index.294ad36c.png" alt="no_index"></p></blockquote> <h5 id="创建索引"><a href="#创建索引" class="header-anchor">#</a> 创建索引</h5> <blockquote><p>唯一索引：CREATE CONSTRAINT ON (h:Hero) ASSERT h.name IS UNIQUE
普通索引：CREATE INDEX FOR (n:Hero) ON (n.name)</p></blockquote> <blockquote><p>:schema
<img src="/assets/img/view_index.59c8fa41.png" alt="view_index"></p></blockquote> <blockquote><p>RETURN (:Hero{name:&quot;曹操&quot;})-[*..1]-&gt;(:Hero)
<img src="/assets/img/has_index.535d87ac.png" alt="has_index"></p></blockquote> <h5 id="删除索引"><a href="#删除索引" class="header-anchor">#</a> 删除索引</h5> <blockquote><p>删除唯一索引：DROP CONSTRAINT ON (h:Hero) ASSERT h.name IS UNIQUE
删除普通索引：DRO INDEX index_53dd4bad</p></blockquote> <h4 id="cql-cypher-query-language"><a href="#cql-cypher-query-language" class="header-anchor">#</a> CQL（Cypher Query Language）</h4> <ul><li><p>语句结构</p> <div class="language-cypher extra-class"><pre class="language-cypher"><code><span class="token punctuation">[</span><span class="token keyword">MATCH</span> <span class="token keyword">WHERE</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">OPTIONAL</span> <span class="token keyword">MATCH</span> <span class="token keyword">WHERE</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">WITH</span> <span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">SKIP</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">LIMIT</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">MERGE</span><span class="token punctuation">)</span><span class="token operator">*</span>
<span class="token punctuation">[</span><span class="token keyword">SET</span> <span class="token operator">|</span> <span class="token keyword">DELETE</span> <span class="token operator">|</span> <span class="token keyword">REMOVE</span> <span class="token operator">|</span> <span class="token keyword">FOREACH</span><span class="token punctuation">]</span><span class="token operator">*</span>
<span class="token punctuation">[</span><span class="token keyword">RETURN</span> <span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">SKIP</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">LIMIT</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div></li> <li><p>运算符</p> <ul><li><code>+, -, *, /, %, ^</code></li> <li><code>=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=</code></li> <li><code>AND, OR, XOR, NOT</code></li> <li>字符串运算符：<code>+</code></li> <li>列表运算符：<code>+, IN, [x], [x .. y]</code></li> <li>正则表达式运算符：<code>=~</code></li> <li>字符串匹配运算符：<code>STARTS WITH, ENDS WITH, CONTAINS</code></li></ul></li></ul> <div class="language-cypher extra-class"><pre class="language-cypher"><code># <span class="token punctuation">(</span>变量别名<span class="token operator">:</span>节点<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>关系别名<span class="token operator">:</span>关系<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>变量别名<span class="token number">2</span><span class="token operator">:</span>节点<span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>关系<span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token operator">..</span>N<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token operator">:</span>节点<span class="token number">3</span><span class="token punctuation">)</span>
                  
# 查找
<span class="token keyword">match</span> p<span class="token operator">=</span><span class="token function">shortestPath</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹操&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;袁绍&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span>

<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">121</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;刘备&quot;</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;刘备&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token keyword">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;曹操&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;刘备&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;孙权&quot;</span><span class="token punctuation">]</span> <span class="token keyword">RETURN</span> n <span class="token keyword">AS</span> result<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token keyword">STARTS</span> <span class="token keyword">WITH</span> <span class="token string">&quot;曹&quot;</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token operator">&lt;&gt;</span> <span class="token string">&quot;刘备&quot;</span> <span class="token keyword">AND</span> n<span class="token punctuation">.</span>name <span class="token keyword">STARTS</span> <span class="token keyword">WITH</span> <span class="token string">&quot;刘&quot;</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token keyword">STARTS</span> <span class="token keyword">WITH</span> <span class="token string">&quot;刘&quot;</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">.</span>name <span class="token keyword">UNION</span> <span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token keyword">STARTS</span> <span class="token keyword">WITH</span> <span class="token string">&quot;曹&quot;</span> <span class="token keyword">RETURN</span> n<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">MATCH</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹操&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>大王<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token keyword">STARTS</span> <span class="token keyword">WITH</span> <span class="token string">&quot;夏侯&quot;</span> <span class="token keyword">WITH</span> m<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">AS</span> count_n <span class="token keyword">RETURN</span> count_n

# 更新
<span class="token keyword">match</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;超昂&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">set</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;曹昂&quot;</span>

# 创建
<span class="token keyword">WITH</span> <span class="token punctuation">[</span><span class="token string">&quot;魏&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;吴&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;蜀&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span> col <span class="token keyword">FOREACH</span> <span class="token punctuation">(</span>v <span class="token keyword">IN</span> col <span class="token operator">|</span> <span class="token keyword">CREATE</span> <span class="token punctuation">(</span><span class="token operator">:</span><span class="token class-name">Country</span><span class="token punctuation">{</span>name<span class="token operator">:</span>v<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">match</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;甄氏&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token punctuation">(</span><span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;甄氏&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;袁熙&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹丕&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span>o<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;甄氏&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>妻子<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>妾<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;黄月英&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;诸葛亮&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>妻子<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>        
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;张飞&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;刘禅&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>岳父<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">match</span> p<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;孙权&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">*</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;孙坚&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;袁术&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>臣<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹嵩&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span><span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹腾&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>义父<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span><span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹腾&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token operator">:</span>义父<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹嵩&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">delete</span> r<span class="token punctuation">;</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;曹腾&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">delete</span> m<span class="token punctuation">;</span>

# 删除
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;甄氏&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">detach</span> <span class="token keyword">delete</span> m

<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token operator">:</span>主公<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">create</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span>大王<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">match</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token operator">:</span>主公<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Hero</span><span class="token punctuation">)</span> <span class="token keyword">delete</span> r
</code></pre></div><h4 id="客户端驱动"><a href="#客户端驱动" class="header-anchor">#</a> 客户端驱动</h4> <blockquote><p><img src="/assets/img/image-20210227175536559.166138cc.png" alt="image-20210227175536559">
https://neo4j.com/download-center/#community</p></blockquote> <p><strong>以 Node.js 为例</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> neo4j-driver
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> neo4j <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;neo4j-driver&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> driver <span class="token operator">=</span> neo4j<span class="token punctuation">.</span><span class="token function">driver</span><span class="token punctuation">(</span><span class="token string">&quot;bolt://localhost:7687&quot;</span><span class="token punctuation">,</span> neo4j<span class="token punctuation">.</span>auth<span class="token punctuation">.</span><span class="token function">basic</span><span class="token punctuation">(</span><span class="token string">&quot;neo4j&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> session <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

session<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&quot;MATCH (h:Hero) WHERE h.name STARTS WITH '曹' RETURN h&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> records <span class="token operator">=</span> result<span class="token punctuation">.</span>records
    records<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-shell"><code>$ node index.js
<span class="token punctuation">{</span> name: <span class="token string">'曹操'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹嵩'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹真'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹仁'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹丕'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹爽'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹纯'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> name: <span class="token string">'曹植'</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h4> <ul><li>Cypher 语法：https://neo4j.com/docs/cypher-manual/4.2/</li> <li>示例数据集：https://github.com/wangfangye/kg-hongloumeng/tree/master/data/data</li> <li>《Neo4j 全栈开发》：https://www.jb51.net/books/701559.html</li> <li>https://gitbook.cn/books/5a33782c5778440a9d906017/index.html</li> <li>https://blog.csdn.net/RHJlife/article/details/108586578</li> <li>http://www.openkg.cn/group</li></ul> <h4 id="todo"><a href="#todo" class="header-anchor">#</a> TODO</h4> <p>底层数据存储（原生、关系型数据库）</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/27/2021, 11:46:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/openresty/openresty.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        OpenResty
      </a></span> <span class="next"><a href="/books-note.html">
        读书笔记
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.40b884d2.js" defer></script><script src="/assets/js/3.3ea64767.js" defer></script><script src="/assets/js/6.6ba35d9e.js" defer></script>
  </body>
</html>