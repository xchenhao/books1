<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>服务器配置类问题 | 不可思议</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="xchenhao.gitee.io">
    <link rel="preload" href="/assets/css/0.styles.8dfbbd61.css" as="style"><link rel="preload" href="/assets/js/app.40b884d2.js" as="script"><link rel="preload" href="/assets/js/3.3ea64767.js" as="script"><link rel="preload" href="/assets/js/18.1b560f70.js" as="script"><link rel="prefetch" href="/assets/js/10.6702d7bf.js"><link rel="prefetch" href="/assets/js/11.81620c6a.js"><link rel="prefetch" href="/assets/js/12.6eec5261.js"><link rel="prefetch" href="/assets/js/13.eecbe465.js"><link rel="prefetch" href="/assets/js/14.a6c5e4ea.js"><link rel="prefetch" href="/assets/js/15.777c418c.js"><link rel="prefetch" href="/assets/js/16.6f3fce90.js"><link rel="prefetch" href="/assets/js/17.14876ee0.js"><link rel="prefetch" href="/assets/js/19.db99086f.js"><link rel="prefetch" href="/assets/js/20.4ced4823.js"><link rel="prefetch" href="/assets/js/21.1c9b0c54.js"><link rel="prefetch" href="/assets/js/22.5873aa3a.js"><link rel="prefetch" href="/assets/js/23.57ddda35.js"><link rel="prefetch" href="/assets/js/24.b7444309.js"><link rel="prefetch" href="/assets/js/25.fdf77843.js"><link rel="prefetch" href="/assets/js/26.a9d42d14.js"><link rel="prefetch" href="/assets/js/27.a5a51ade.js"><link rel="prefetch" href="/assets/js/28.5561ecd0.js"><link rel="prefetch" href="/assets/js/29.e63bd8d1.js"><link rel="prefetch" href="/assets/js/30.59249eab.js"><link rel="prefetch" href="/assets/js/31.79abfa92.js"><link rel="prefetch" href="/assets/js/32.8fdf366b.js"><link rel="prefetch" href="/assets/js/33.42a288d4.js"><link rel="prefetch" href="/assets/js/34.779de91e.js"><link rel="prefetch" href="/assets/js/35.8ee608aa.js"><link rel="prefetch" href="/assets/js/36.629e5b79.js"><link rel="prefetch" href="/assets/js/37.af2f9fe5.js"><link rel="prefetch" href="/assets/js/38.9433c305.js"><link rel="prefetch" href="/assets/js/39.21a61ab5.js"><link rel="prefetch" href="/assets/js/4.0543ed79.js"><link rel="prefetch" href="/assets/js/40.003f2546.js"><link rel="prefetch" href="/assets/js/41.3b6d6a34.js"><link rel="prefetch" href="/assets/js/42.4d8658cf.js"><link rel="prefetch" href="/assets/js/43.952f8d77.js"><link rel="prefetch" href="/assets/js/44.423bdace.js"><link rel="prefetch" href="/assets/js/45.2500955f.js"><link rel="prefetch" href="/assets/js/46.e4d8c366.js"><link rel="prefetch" href="/assets/js/47.07e64e10.js"><link rel="prefetch" href="/assets/js/48.b7f8badf.js"><link rel="prefetch" href="/assets/js/49.12d47ca3.js"><link rel="prefetch" href="/assets/js/5.f05ac99b.js"><link rel="prefetch" href="/assets/js/50.85353aa7.js"><link rel="prefetch" href="/assets/js/51.8a57beb8.js"><link rel="prefetch" href="/assets/js/52.638d584e.js"><link rel="prefetch" href="/assets/js/53.4c571960.js"><link rel="prefetch" href="/assets/js/54.bc41d0b5.js"><link rel="prefetch" href="/assets/js/55.43685358.js"><link rel="prefetch" href="/assets/js/6.6ba35d9e.js"><link rel="prefetch" href="/assets/js/7.7b187e09.js"><link rel="prefetch" href="/assets/js/8.e7e79ea1.js"><link rel="prefetch" href="/assets/js/9.97236a62.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.d51abae4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8dfbbd61.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">不可思议</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          数据库
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          语言
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MySQL</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/note1.html" title="MySQL 笔记 1" class="sidebar-link">MySQL 笔记 1</a></li><li><a href="/mysql/about_version.html" title="版本类问题" class="sidebar-link">版本类问题</a></li><li><a href="/mysql/about_user.html" title="用户管理类问题" class="sidebar-link">用户管理类问题</a></li><li><a href="/mysql/about_config.html" aria-current="page" title="服务器配置类问题" class="active sidebar-link">服务器配置类问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/mysql/about_log.html" title="日志类问题" class="sidebar-link">日志类问题</a></li><li><a href="/mysql/about_engine.html" title="存储引擎类问题" class="sidebar-link">存储引擎类问题</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shell</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其它</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><a href="/books-note.html" title="读书笔记" class="sidebar-link">读书笔记</a></li><li><a href="/update_log.html" title="更新记录" class="sidebar-link">更新记录</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h3 id="服务器配置类问题"><a href="#服务器配置类问题" class="header-anchor">#</a> 服务器配置类问题</h3> <ol><li>请分析一个Group By语句的异常原因</li> <li>如何比较系统运行配置和配置文件中的配置是否一致？</li> <li>举几个MYSQL中的关建性能参数</li></ol> <ul><li><p>分析一个 GroupBy 语句的异常原因</p> <table><thead><tr><th>product_id</th> <th>category_id</th> <th>warehouse_id</th> <th>count</th></tr></thead> <tbody><tr><td>2030</td> <td>9</td> <td>1</td> <td>10</td></tr> <tr><td>2030</td> <td>9</td> <td>2</td> <td>15</td></tr> <tr><td>2030</td> <td>9</td> <td>3</td> <td>20</td></tr> <tr><td>2040</td> <td>8</td> <td>1</td> <td>30</td></tr> <tr><td>2040</td> <td>8</td> <td>2</td> <td>20</td></tr></tbody></table> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> product_id，warehouse_id，sum（count）<span class="token keyword">as</span> cnt <span class="token keyword">from</span> stock <span class="token keyword">group</span> <span class="token keyword">by</span> product_id；
</code></pre></div><p>知识点：SQL_MODE 的作用</p> <ul><li><p>配置MySQL处理SQL的方式</p></li> <li><p>set [session/global/persist] sql_mode='xxxxxx</p></li> <li><p>[mysqld] sqlmode=xxxxxx</p> <table><thead><tr><th>SQL_MODE</th> <th>说明</th></tr></thead> <tbody><tr><td>ONLY_FULL_GROUP_BY</td> <td>对于GROUP BY聚合操作，如果出现在SELECT中的列、HAVING或者ORDER BY子句的非聚合列，没有在GROUP BY中出现，那么这个SQL语法检查报错。</td></tr> <tr><td>ANSI QUOTES</td> <td>禁止用双引号来引用字符串。</td></tr> <tr><td>REAL_AS_FLOAT</td> <td>Real做为float的同义词</td></tr> <tr><td>PIPES_AS_CONCAT</td> <td>将 || 视为字符串的连接操作符而非或运算符</td></tr> <tr><td>STRICT_TRANS_TABLES<br>STRICT_ALL_TABLES</td> <td>在事务存储引擎/所有存储引擎上启用严格模式出现，那么这个SQL语法检查报错。</td></tr> <tr><td>ERROR_FOR_DIVISION_BY_ZERO</td> <td>不允许0做为除数</td></tr> <tr><td>NO_AUTO_CREATE_USER</td> <td>在用户不存在时不允许grant语句自动建立用</td></tr> <tr><td>NO_ZERO_IN_DATE<br>NO_ZERO_DATE</td> <td>日期数据内/日期数据不能含0</td></tr> <tr><td>NO_ENGINE_SUBSTITUTION</td> <td>当指定的存储引擎不可用时报错。</td></tr></tbody></table> <div class="language-sh extra-class"><pre class="language-sh"><code>mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'sql_model'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> session <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">'NO_ENGINE_SUBSTITUTION, only_full_group_by'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> product_id, warehouse_id, sum<span class="token punctuation">(</span>count<span class="token punctuation">)</span> as cnt from stock group by product_id<span class="token punctuation">;</span>
ERROR <span class="token number">1055</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span>: Expression <span class="token comment">#2 of SELECT list is not in GROUP BY clause and contains nonaggregated column ' stock. stock. warehouse_id' which is not functionally dependent on colum ns in GROUP BY clause; this is incompatible with sql_mode-only_ful1_group_by </span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> product_id, warehouse_id, sum<span class="token punctuation">(</span>count<span class="token punctuation">)</span> as cnt from stock group by product_id, warehouse_id<span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">&quot;ansi_quotes, ONLY_FULL_GROUP_BY, NO_ENGINE_SUBSTITUTION&quot;</span><span class="token punctuation">;</span> 
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token string">&quot;this is a string&quot;</span><span class="token punctuation">;</span> 
ERROR <span class="token number">1054</span> <span class="token punctuation">(</span>42S22<span class="token punctuation">)</span>: Unknown <span class="token function">column</span> <span class="token string">'this is a string'</span> <span class="token keyword">in</span> <span class="token string">'field list'</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token string">'this is a string'</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> create table t <span class="token punctuation">(</span>id real<span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> show create table t<span class="token punctuation">\</span>G 
Table：t 
create Table：CREATE TABLE t <span class="token punctuation">(</span>id double DEFAULT NULL<span class="token punctuation">)</span>ENGINE-InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>utf8
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> session <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">'real_as_float'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> drop table t<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> create table；t<span class="token punctuation">(</span>id real<span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> show create table t<span class="token punctuation">\</span>G
Table：t 
create Table：CREATE TABLE t <span class="token punctuation">(</span>id float DEFAULT NULL<span class="token punctuation">)</span>ENGINE-InnoDB DEFAULT <span class="token assign-left variable">CHARSET</span><span class="token operator">=</span>utf8

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token string">'hello'</span> <span class="token operator">||</span> <span class="token string">'mooc.com'</span><span class="token punctuation">;</span>
<span class="token number">0</span>
<span class="token number">1</span> row <span class="token keyword">in</span> set, <span class="token number">2</span> warnings
mysql<span class="token operator">&gt;</span> show warnings<span class="token punctuation">;</span>
Truncated incorrect DOUBLE value: <span class="token string">'hello'</span>
Truncated incorrect DOUBLE value: <span class="token string">'imooc.com'</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'hello'</span>, <span class="token string">'imooc.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hello imooc.com
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> session <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">'pipes_as_concat'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token string">'hello'</span> <span class="token operator">||</span> <span class="token string">'mooc.com'</span><span class="token punctuation">;</span>
hello imooc.com

mysql<span class="token operator">&gt;</span> create table t2<span class="token punctuation">(</span>id int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> default null<span class="token punctuation">)</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> insert into t2<span class="token punctuation">(</span><span class="token string">'ansi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">1</span> row affected, <span class="token number">1</span> warning
mysql<span class="token operator">&gt;</span> show warnings<span class="token punctuation">;</span>
Incorrect integer value: <span class="token string">'ansi'</span> <span class="token keyword">for</span> <span class="token function">column</span> <span class="token string">'id'</span> at row <span class="token number">1</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from t2<span class="token punctuation">\</span>G
id: <span class="token number">0</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">'strict_trans_tables'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> insert into t2 values<span class="token punctuation">(</span><span class="token string">'ansi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1366</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Incorrect integer value: <span class="token string">'ansi'</span> <span class="token keyword">for</span> <span class="token function">column</span> <span class="token string">'id'</span> at row <span class="token number">1</span>


mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">' strict_trans_tables,error_for_division_by_zero'</span><span class="token punctuation">;</span>
<span class="token number">0</span> rows affected, <span class="token number">1</span> warning
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token number">1</span>/0<span class="token punctuation">\</span>G
<span class="token number">1</span>/0: NULL
<span class="token number">1</span> row <span class="token keyword">in</span> sect, <span class="token number">1</span> warning
mysql<span class="token operator">&gt;</span> show warnings<span class="token punctuation">;</span>
Division by <span class="token number">0</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">sql_mode</span><span class="token operator">=</span><span class="token string">'ansi'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token number">1</span>/0<span class="token punctuation">\</span>G
<span class="token number">1</span>/0: NULL
</code></pre></div></li></ul></li></ul> <ul><li><p>比较系统运行配置和配置文件中的配置</p> <p>知识点</p> <ul><li><p>使用set命令配置动态参数</p> <p>set [session | @@session.] system_var_name = expr</p> <p>set [global | @@global.] system_var_name = expr</p> <p>set [persist | @@persist.] system_var_name= expr</p> <div class="language-sh extra-class"><pre class="language-sh"><code>mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'wait_timeout'</span><span class="token punctuation">;</span>
<span class="token number">28800</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> global <span class="token assign-left variable">wait_timeout</span><span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'wait_timeout'</span><span class="token punctuation">;</span>
<span class="token number">28800</span>
mysql<span class="token operator">&gt;</span> show global variables like <span class="token string">'wait_timeout'</span><span class="token punctuation">;</span>
<span class="token number">300</span>
mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'max_connections%'</span><span class="token punctuation">;</span>
<span class="token number">4000</span>
mysql<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> persist <span class="token assign-left variable">max_connections</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> show variables like <span class="token string">'max_connections%'</span><span class="token punctuation">;</span>
<span class="token number">1000</span>

$ <span class="token function">ls</span> /home/mysql/data/
<span class="token punctuation">..</span>. mysqld-auto.cnf <span class="token punctuation">..</span>.
$ <span class="token function">more</span> mysqld-auto.cnf
<span class="token punctuation">{</span> <span class="token string">&quot;version&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;mysql_server&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;max_connections&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;value&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;1000&quot;</span> , <span class="token string">&quot;Metadata&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Timestamp&quot;</span> <span class="token number">1535290066405068</span>, <span class="token string">&quot;user&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;root&quot;</span> , <span class="token string">&quot;Host&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1ocalhost&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>使用pt-config-diff工具比较配置文件</p> <p>pt-config-diff u=root,p=,h=localhost /etc/my. cnf</p> <p><img src="/assets/img/pt-config.1315e209.png" alt="image-20201205155913329"></p></li> <li><p>举几个MySQL中的关键性能参数</p> <p>知识点</p> <p>常用的性能参数</p> <table><thead><tr><th></th> <th>参数</th> <th>说明</th></tr></thead> <tbody><tr><td>服务器配置参数</td> <td></td> <td></td></tr> <tr><td></td> <td>max_connections</td> <td>设置MySQL允许访问的最大连接数量</td></tr> <tr><td></td> <td>interactive_timeout</td> <td>设置交互连接的timeout时间</td></tr> <tr><td></td> <td>wait_timeout</td> <td>设置非交互连接的timeout时间</td></tr> <tr><td></td> <td>max_allowed_packet</td> <td>控制MySQL可以接收的数据包的大小</td></tr> <tr><td></td> <td>sync_binlog</td> <td>表示每写多少次缓冲会向磁盘同步一次binlog</td></tr> <tr><td></td> <td>sort _buffer_size</td> <td>设置每个会话使用的排序缓存区的大小</td></tr> <tr><td></td> <td>join_buffer_size</td> <td>设置每个会话所使用的连接缓冲的大小</td></tr> <tr><td></td> <td>read_buffer_size</td> <td>指定了当对一个MYISAM进行表扫描时所分配的读缓存池的大小</td></tr> <tr><td></td> <td>read_rnd_buffer_size</td> <td>设置控制索引缓冲区的大小</td></tr> <tr><td></td> <td>binlog_cache_size</td> <td>设置每个会话用于缓存未提交的事务缓存大小</td></tr> <tr><td>存储引擎参数</td> <td></td> <td></td></tr> <tr><td></td> <td>innodb flush_log_at_trx_commit</td> <td>0：每秒进行一次重做日志的磁盘刷新操作。<br>1：每次事务提交都会刷新事务日志到磁盘中。<br>2：每次事务提交写入系统缓存每秒向磁盘刷新一次</td></tr> <tr><td></td> <td>innodb_buffer_pool_size</td> <td>设置Innodb缓冲池的大小，应为系统可用内存的75%。</td></tr> <tr><td></td> <td>innodb_buffer_pool_instances</td> <td>Innodb缓冲池的实例个数，每个实例的大小为总缓冲池大小/实例个数。</td></tr> <tr><td></td> <td>innodb_file_per_table</td> <td>设置每个表独立使用一个表空间文件</td></tr></tbody></table></li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/5/2020, 5:52:23 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/mysql/about_user.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        用户管理类问题
      </a></span> <span class="next"><a href="/mysql/about_log.html">
        日志类问题
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.40b884d2.js" defer></script><script src="/assets/js/3.3ea64767.js" defer></script><script src="/assets/js/18.1b560f70.js" defer></script>
  </body>
</html>